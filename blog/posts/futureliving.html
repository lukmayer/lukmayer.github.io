<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.42">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Luke">
<meta name="dcterms.date" content="2025-06-25">
<meta name="description" content="Letting my inner hobby economist run loose">

<title>Which countries are equipped to handle a storm? – lukmayer.github.io</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../assets/favicons/favicon.ico" rel="icon">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-2fa0555fe88427c29efa1b60aaf9e62d.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-dark-6d7e7b9b3dbd114c66b233ded7072392.css" rel="stylesheet" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap-7945e2a833f1e1b32e2a8ee894f2be5e.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../../site_libs/bootstrap/bootstrap-dark-034891b1a1cc1f845fd10fe5f270baab.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<style>html{ scroll-behavior: smooth; }</style>
<link href="../../site_libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet">
<script src="../../site_libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<link href="../../site_libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet">
<script src="../../site_libs/datatables-binding-0.33/datatables.js"></script>
<script src="../../site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<link href="../../site_libs/dt-core-1.13.6/css/jquery.dataTables.min.css" rel="stylesheet">
<link href="../../site_libs/dt-core-1.13.6/css/jquery.dataTables.extra.css" rel="stylesheet">
<script src="../../site_libs/dt-core-1.13.6/js/jquery.dataTables.min.js"></script>
<link href="../../site_libs/dt-ext-buttons-1.13.6/css/buttons.dataTables.min.css" rel="stylesheet">
<script src="../../site_libs/dt-ext-buttons-1.13.6/js/dataTables.buttons.min.js"></script>
<script src="../../site_libs/dt-ext-buttons-1.13.6/js/buttons.html5.min.js"></script>
<script src="../../site_libs/dt-ext-buttons-1.13.6/js/buttons.colVis.min.js"></script>
<script src="../../site_libs/dt-ext-buttons-1.13.6/js/buttons.print.min.js"></script>
<link href="../../site_libs/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet">
<script src="../../site_libs/crosstalk-1.2.1/js/crosstalk.min.js"></script>


<link rel="stylesheet" href="../../styles.css">
<meta property="og:title" content="Which countries are equipped to handle a storm? – lukmayer.github.io">
<meta property="og:description" content="Letting my inner hobby economist run loose">
<meta property="og:image" content="https://lukmayer.github.io/blog/posts/images/countries.jpg">
<meta property="og:site_name" content="lukmayer.github.io">
<meta name="twitter:title" content="Which countries are equipped to handle a storm? – lukmayer.github.io">
<meta name="twitter:description" content="Letting my inner hobby economist run loose">
<meta name="twitter:image" content="https://lukmayer.github.io/blog/posts/images/countries.jpg">
<meta name="twitter:card" content="summary_large_image">
<link rel="canonical" href="https://lukmayer.github.io/blog/posts/futureliving.html">
</head>

<body class="floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">lukmayer.github.io</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../research/index.html"> 
<span class="menu-text">Research</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../cv/index.html"> 
<span class="menu-text">CV</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../blog/index.html"> 
<span class="menu-text">Blog</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../about/index.html"> 
<span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../now/index.html"> 
<span class="menu-text">Now</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="https://lukmayer.github.io/login_portal/"> 
<span class="menu-text">Login</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default toc-left page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Which countries are equipped to handle a storm?</h1>
                  <div>
        <div class="description">
          Letting my inner hobby economist run loose
        </div>
      </div>
                          <div class="quarto-categories">
                <div class="quarto-category">r</div>
                <div class="quarto-category">life</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Luke </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">June 25, 2025</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <nav id="TOC" role="doc-toc" class="toc-active" data-toc-expanded="4">
    <h2 id="toc-title">Sections:</h2>
   
  <ul>
  <li><a href="#the-problem" id="toc-the-problem" class="nav-link active" data-scroll-target="#the-problem">The problem</a></li>
  <li><a href="#method" id="toc-method" class="nav-link" data-scroll-target="#method">Method</a></li>
  <li><a href="#results" id="toc-results" class="nav-link" data-scroll-target="#results">Results</a></li>
  <li><a href="#conclusion" id="toc-conclusion" class="nav-link" data-scroll-target="#conclusion">Conclusion</a></li>
  <li><a href="#appendix" id="toc-appendix" class="nav-link" data-scroll-target="#appendix">Appendix</a>
  <ul>
  <li><a href="#code" id="toc-code" class="nav-link" data-scroll-target="#code">Code</a></li>
  <li><a href="#data" id="toc-data" class="nav-link" data-scroll-target="#data">Data</a></li>
  <li><a href="#sessioninfo" id="toc-sessioninfo" class="nav-link" data-scroll-target="#sessioninfo">SessionInfo</a></li>
  </ul></li>
  </ul>
</nav>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar zindex-bottom">
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">





<!-- Debt -->
<!-- EC -->
<!-- GDP -->
<!-- Innovation -->
<!-- Social mobility -->
<!-- Social progress -->
<!-- GINI -->
<!-- Gini trend -->
<!-- Country name check -->
<!-- 
NO EC: Iceland, Luxembourg, Malta
Not enough GINI: New Zealand, Singapore 
-->
<p>So far, I have never felt all that attached to where I live. I think that’s a big part in why I left Germany when I was 19, having since then lived in Scotland, different places in England, and now the USA. However, I do feel like I should settle down once my studies are over, so it’s been a bit of a personal hobby of mine to think about what my location priorities would be.</p>
<p>There are a lot of factors one could possibly consider, many of which are deeply personal. For example, would you prefer to speak a certain language, live in a place that has good opportunities in your industry, do you like the nature there, the culture, the people, the food, the politics? Once you have answered all these questions, you could, at least in principle, evaluate different cities within that country according to your priorities for the local situation. Of course, life never actually works out according to these kinds of master plans, and yet it is kind of fun to think about the possibilities.</p>
<p><br>
</p>
<section id="the-problem" class="level2">
<h2 class="anchored" data-anchor-id="the-problem">The problem</h2>
<p>Not to be a debbie downer or anything, but I am in some ways kind of pessimistic about the future of humanity as a whole. Not in the nuclear fallout, skynet killer AI kind of way, but more so the “Can I reasonably expect to ever be more financially secure than my parents?” kind of way.</p>
<p>Without wanting to put my doomer hat on, I think it’s fair to say that:</p>
<ul>
<li>We are probably past peak globalism for a good little while, meaning less economic growth, more uncertainty etc.</li>
<li>Inequality is rising fast, increasingly eradicating the concept of there existing a “middle class”</li>
<li>Populations are declining across the board, which poses existential risks for government financed services like public healthcare systems.</li>
<li>Lots of other stuff that’s out of the scope for this post</li>
</ul>
<p>So the question is, is there anywhere that’s bucking these trends? When you start searching around a bit rather than just judging places by the vibes, you’ll quickly learn that economists come up with all sorts of whimsical indexes to compare countries to each other with.</p>
<p>So I’ve decided I’d see whether I can make somewhat sensible relative judgments of the future readiness of different countries by using these indexes other people have thought long and hard about. Given my bullet list of challenges above, I’ve picked out a few that seem relevant:</p>
<ul>
<li><a href="https://en.wikipedia.org/wiki/List_of_countries_by_economic_complexity">Economic Complexity Index</a>: Because the more diverse your economy the better you can handle some recessions here and there while the rest of the world is on fire.</li>
<li><a href="https://en.wikipedia.org/wiki/Global_Social_Mobility_Index#Global_Social_Mobility_Index_(2020)_results">Social Mobility Index</a>: As an indicator of relatively low inequality</li>
<li><a href="https://data.un.org/Data.aspx?d=WDI&amp;f=Indicator_Code%3ASI.POV.GINI">Gini index</a>: Specifically the trend in Gini over time, since that would be indicative of the change in inequality during recent years.</li>
<li><a href="https://en.wikipedia.org/wiki/List_of_countries_by_government_debt">Government debt as percent of GDP</a>: Because if you’re going through a bit of a rough patch, like a demographic crisis, you need to be able to have the cash at hand to be able to push through those hard times.</li>
</ul>
<p>I’ve also picked out a few ones that just feel like they’d be somewhat indicative of living a nicer life:</p>
<ul>
<li><a href="https://en.wikipedia.org/wiki/List_of_countries_by_GDP_(PPP)_per_capita">GDP per capita (Purchasing Power Parity)</a>: Cuz money makes the world go round.</li>
<li><a href="https://en.wikipedia.org/wiki/Social_Progress_Index">Social Progress Index</a>: As it seems to reflect provision of and access to high quality public services.</li>
<li><a href="https://en.wikipedia.org/wiki/Global_Innovation_Index">Global innovation Index</a>: Probably useful as a very high-level indicator of future economic opportunities.</li>
</ul>
<p><br>
</p>
</section>
<section id="method" class="level2">
<h2 class="anchored" data-anchor-id="method">Method</h2>
<p>I grabbed most of the data from Wikipedia by using the <a href="https://wikitable2csv.ggor.de">Wikitable2csv website</a>. Only the Gini by year data I had to grab from the website of the United Nations.</p>
<p>I basically cleaned up each dataset separately, with the intention of eventually doing a complete-cases analysis. For the Gini time-series data, I decided I would fit linear regression models to each country that had at least 10 data points between 1980 and 2025. So the slope estimate is indicative of the trend. This is definitely not statistically sound, but it is decidedly convenient. I decided 1980 should be the cut-off point for the time trends based on my impression that this is around where many developed countries started to take a turn for the worse in terms of inequality. For the GDP estimates, I used the ones provided by the WorldBank.</p>
<p>Many countries did not meet all my data requirements. Of course, most of these are developing countries where accurate information is hard to find. That being said, these countries are pretty unlikely to have topped the charts of my analysis anyway. Some smaller, developed countries lacked at least one of my metrics. For example, Iceland and Luxembourg are not included in the Economic Complexity Index, and New Zealand and Singapore did not have enough Gini data for my time trend estimations. Dropping these from the data is a real shame, since I would expect them to rank fairly highly if the information had been available. So when you look at my results later, keep in mind that some noteworthy contenders are not included.</p>
<p>With all of this out the way, I merged all the data together and only retained countries that have all the records I wanted. 62 countries pass all the checks. I decided to rank countries by a composite score derived from the variables I’ve prepared. Ultimately, I used the Z-score of each variable and simply calculate the row sum for each country. Z-scores are pretty neat as they standardize all variables to the scale of standard deviations from the mean, meaning that not only are all variables now in the same unit, differences between countries are still accurately retained (unlike rank-scoring). For the row sum of my Z-scored variables to be valid, I needed to ensure that all variables follow a similar distribution, so I used the Box-Cox method to automatically find the optimal transformation that makes my values normally distributed. The Box-Cox transform is only valid for positive values, meaning I additionally had to add the minimum of a variable to its values, if that variable featured negative values. Of course, I inverted the Z-scores for debt as percent of GDP and Gini time trend, since less debt is better, and decreasing Gini is better. Note that my composite score thus implicitly applies equal weights to all variables included.</p>
<p><br>
</p>
</section>
<section id="results" class="level2">
<h2 class="anchored" data-anchor-id="results">Results</h2>
<p>So that’s how I arrived at this table:</p>
<div class="cell">
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-589eb065973fbfd1345c" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-589eb065973fbfd1345c">{"x":{"filter":"none","vertical":false,"extensions":["Buttons"],"data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62"],[51,41,49,21,6,59,13,46,33,15,37,31,50,38,28,26,14,5,55,57,58,17,4,12,44,3,34,60,23,54,52,8,19,18,62,43,29,24,32,40,47,7,11,61,45,56,53,27,22,30,36,25,16,20,2,1,39,42,9,10,35,48],["Albania","Argentina","Armenia","Australia","Austria","Bangladesh","Belgium","Brazil","Bulgaria","Canada","Chile","China","Colombia","Costa Rica","Croatia","Cyprus","Czech Republic","Denmark","Ecuador","Egypt","El Salvador","Estonia","Finland","France","Georgia","Germany","Greece","Honduras","Hungary","India","Indonesia","Ireland","Israel","Italy","Ivory Coast","Kazakhstan","Latvia","Lithuania","Malaysia","Mexico","Moldova","Netherlands","Norway","Pakistan","Panama","Paraguay","Peru","Poland","Portugal","Romania","Serbia","Slovakia","Slovenia","Spain","Sweden","Switzerland","Thailand","Ukraine","United Kingdom","United States","Uruguay","Vietnam"],[-3.86,-2.56,-3.46,2.44,6.03,-8.75,4.68,-3.28,-0.15,3.9,-1.39,0.3,-3.85,-1.41,1.12,1.56,4.36,6.21,-5.58,-5.99,-6.16,3.52,6.71,4.87,-2.88,6.95,-0.42,-8.76,2.05,-5.24,-4.69,5.25,3.16,3.3,-9.67,-2.69,1.03,2.03,0.14,-1.77,-3.42,5.7,5,-9.67,-3.22,-5.65,-5.1,1.55,2.4,0.74,-1.06,1.76,3.84,2.51,7.23,8.52,-1.47,-2.64,5.21,5.18,-0.98,-3.46],[-0.32,-0.21,-0.39,-0.53,1.81,-0.88,1.18,0.21,0.55,0.65,-0.18,1.34,0.1,0.33,0.87,0.18,1.8,1.09,-0.97,-0.06,0.13,0.96,1.55,1.37,-0.04,2.09,0.11,-0.67,1.66,0.54,0.02,1.36,1.2,1.44,-0.96,-0.59,0.7,0.86,1.03,1.29,-0.18,0.98,0.44,-0.68,-0.24,-0.55,-0.8100000000000001,1.1,0.8,1.34,0.67,1.41,1.62,0.83,1.7,2.17,1.17,0.37,1.51,1.55,0.02,0.14],[0.12,-0.14,-0.28,0.07000000000000001,0.03,0.18,0.02,-0.21,0.47,0.04,-0.41,0.11,-0.06,0.12,-0.35,0.09,0.03,0.14,-0.32,-0,-0.53,-0.19,0.13,-0.01,-0.17,0.13,-0.05,-0.19,0.02,0.07000000000000001,0.2,-0.18,0.04,0.1,-0.06,-0.39,-0.16,0.09,-0.22,-0.25,-0.67,-0.05,0.05,-0.1,-0.33,-0.3,-0.58,-0.46,-0.28,-0.21,-0.85,-0.21,-0.01,0.02,0.18,-0.05,-0.31,-0.32,0.05,0.12,-0.09,0],[24.5,26.4,29,48.1,50.3,19.1,47.7,32.7,38.5,52.9,32.6,56.3,29.2,28.3,36.3,45.1,44,57.1,19.3,23.7,20.6,52.3,59.4,55.4,30.4,58.1,36.2,16.7,39.6,38.3,30.6,50,52.7,45.3,17.5,25.7,36.4,40.1,40.5,30.4,28.7,58.8,49.1,22,24.7,21.9,26.7,37,43.7,33.4,32.3,34.3,40.2,44.9,64.5,67.5,36.9,29.5,61,62.4,29.1,36.2],[55.6,57.3,53.9,75.09999999999999,80.09999999999999,40.2,80.09999999999999,52.1,63.8,76.09999999999999,60.3,61.5,50.3,61.6,66.7,69.40000000000001,74.7,85.2,53.9,44.8,47.4,73.5,83.59999999999999,76.7,55.6,78.8,59.8,43.5,65.8,42.7,49.3,75,68.09999999999999,67.40000000000001,34.5,64.8,69,70.5,62,52.6,59.6,82.40000000000001,83.59999999999999,36.7,51.4,46.8,49.9,69.09999999999999,72,63.1,63.8,68.5,76.40000000000001,70,83.5,82.09999999999999,55.4,61.2,74.40000000000001,70.40000000000001,67.09999999999999,57.8],[74.12,78.64,74.78,87.83,88.05,56.06,87.22,71.26000000000001,76.81,88.17,80.78,65.73999999999999,69.83,80.65000000000001,82.31999999999999,83.18000000000001,85.19,90.54000000000001,71.75,58.73,64.42,86.16,90.45999999999999,86.06999999999999,74.43000000000001,88.72,82.44,61.17,78.20999999999999,60.19,66.67,87.69,83.17,85.23,54.01,71.20999999999999,82.45999999999999,83.70999999999999,74.08,70.84,74.19,88.97,90.73999999999999,51.32,74.02,68.95999999999999,70.7,80.17,84.75,76.89,75.8,81.29000000000001,84.19,85.34999999999999,89.42,90.26000000000001,69.8,74.17,86.13,84.65000000000001,80.27,68.18000000000001],[58,86.2,53.1,49.6,75.40000000000001,41.4,105,86.7,23.4,104.7,40.5,88.59999999999999,54.4,60.6,59.5,70.7,45.1,29.2,56.5,96.40000000000001,84.40000000000001,23,81.40000000000001,111.6,38.8,63.7,159,44.6,73.5,82.5,39.3,41.2,67.3,136.9,57.7,24.2,43.2,36.2,66.40000000000001,55.6,37.3,47.7,38,71.8,54.1,43.1,33,55.1,94.7,53,49.1,59.3,67.5,106.3,36,36.7,64.5,95.59999999999999,101.8,121,61.9,33.5],[21395,29363,23055,69115,73751,9066,70456,20584,38690,61582,33285,24558,21548,27953,45910,57101,53817,76688,15870,18817,12542,48992,65061,61157,24681,69338,41187,7211,45942,10176,15613,127623,53434,58755,7791,39333,42501,51877,37248,25602,17384,78215,104460,6212,39695,17466,16717,49464,48759,47903,27402,44650,54948,52779,70207,92980,23423,18008,58906,81695,34062,15194]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>Rank<\/th>\n      <th>Country<\/th>\n      <th>Composite.Score<\/th>\n      <th>Economic.Complexity.Index<\/th>\n      <th>GINI.Trend.1980.onwards<\/th>\n      <th>Global.Innovation.Index<\/th>\n      <th>Global.Social.Mobility.Index<\/th>\n      <th>Social.Progress.Index<\/th>\n      <th>Debt.Percent.GDP<\/th>\n      <th>GDP.perCapita.PPP<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":20,"scrollX":true,"order":[[1,"asc"]],"dom":"Bfrtip","buttons":[{"extend":"csv","filename":"data"}],"columnDefs":[{"className":"dt-right","targets":[1,3,4,5,6,7,8,9,10]},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"Rank","targets":1},{"name":"Country","targets":2},{"name":"Composite.Score","targets":3},{"name":"Economic.Complexity.Index","targets":4},{"name":"GINI.Trend.1980.onwards","targets":5},{"name":"Global.Innovation.Index","targets":6},{"name":"Global.Social.Mobility.Index","targets":7},{"name":"Social.Progress.Index","targets":8},{"name":"Debt.Percent.GDP","targets":9},{"name":"GDP.perCapita.PPP","targets":10}],"autoWidth":false,"orderClasses":false,"lengthMenu":[10,20,25,50,100]}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p><br>
</p>
<p>My results are obviously biased in the sense that they critically depend on what metrics are included in the analysis. If you do not care about GDP for example, then your ranking will probably end up looking very different from this one. I hope my reasoning for what is included was somewhat convincing though.</p>
<p>What’s interesting about my results is of course that I’ve taken care of outliers ruining the party by transforming variables before Z-scoring. Ireland is often a bit painful (especially with economic data) since their figures are extremely distorted due to huge multinational companies using tax loopholes there. Here, Ireland still ranks pretty high despite my transformations, so I’d wager you should still be a bit cautious with interpreting its rank. However, you don’t quite get all the usual chart toppers. For example, usually the Nordic countries all but dominate these kinds of rankings. Here, some of them seem to have been punished by having pretty simple economic structures.</p>
<p>The big winner of my ranking is Switzerland, which is actually not surprising at all. The Swiss do pretty well in any metric you throw at them, and they don’t even seem to be experiencing large changes in inequality like some of their neighbors. Ranks 2-5 are all occupied by countries that have experienced steeply rising inequality in recent decades. Especially Germany gets a lot of flak for this, with my impression of the domestic sentiment being that politics in Germany has not been this tense in a long time. Perhaps the resilience of the German economy and it’s relatively strong public institutions ought to inspire more hope for a good future than what the vibes suggest? Ranks 14, 16 and 17, which are the Czech Republic, Slovenia, and Estonia, seem pretty interesting to me, since these are countries that most people sleep on. They seem to be doing pretty well, at least judging by the scores.</p>
<p><br>
</p>
</section>
<section id="conclusion" class="level2">
<h2 class="anchored" data-anchor-id="conclusion">Conclusion</h2>
<p>Please do not take my results too seriously. Despite the fact that I am basing my analyses on some metrics, it should not be forgotten that many of my analysis decisions were done on the basis of impressions. My approach is not exactly rigorous, and you may very well arrive at quite different results. Furthermore, a famous quote that is apparently <a href="https://quoteinvestigator.com/2013/10/20/no-predict/">traceable to the Danes</a> tells us: “Making predictions is hard, especially about the future”.</p>
<p>Nevertheless, I thought it was pretty fun to just throw something together that appears to be a useful description of some of the preferences I hold for what a good place to life constitutes. You can download the table above as CSV, though the variables in that table are still in the original scale for better interpretability, meaning that to replicate my results, you’d have to calculate the Z-Scores yourself. My code is below.</p>
<p>So will I be moving to Switzerland? Well, maybe, though I can trace that interest to at least 2019, meaning this ranking had little to do with it. It’s close to home, (partly) German-speaking, has excellent infrastructure and beautiful nature, what’s not to like? At the end of the day, we make these kinds of decisions based on our subjective values rather than some score. And with that, I hope this was interesting to you!</p>
<p><br>
</p>
</section>
<section id="appendix" class="level2">
<h2 class="anchored" data-anchor-id="appendix">Appendix</h2>
<section id="code" class="level3">
<h3 class="anchored" data-anchor-id="code">Code</h3>
<div class="sourceCode" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="fu">library</span>(DT) <span class="co"># for table</span></span>
<span id="cb1-3"><a href="#cb1-3"></a><span class="fu">library</span>(forecast) <span class="co"># for box-cox</span></span>
<span id="cb1-4"><a href="#cb1-4"></a></span>
<span id="cb1-5"><a href="#cb1-5"></a>debt <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"./assets/data/debt_gdp.csv"</span>)</span>
<span id="cb1-6"><a href="#cb1-6"></a><span class="fu">colnames</span>(debt) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Country"</span>, <span class="st">"Gross_2024"</span>, <span class="st">"Gross_2022"</span>, <span class="st">"Net_2021"</span>)</span>
<span id="cb1-7"><a href="#cb1-7"></a>debt <span class="ot">&lt;-</span> debt <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="fu">c</span>(Country, Gross_2024))</span>
<span id="cb1-8"><a href="#cb1-8"></a>debt<span class="sc">$</span>Gross_2024 <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(debt<span class="sc">$</span>Gross_2024)</span>
<span id="cb1-9"><a href="#cb1-9"></a>debt <span class="ot">&lt;-</span> debt <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(Gross_2024))</span>
<span id="cb1-10"><a href="#cb1-10"></a>debt<span class="sc">$</span>Country <span class="ot">&lt;-</span> <span class="fu">recode</span>(debt<span class="sc">$</span>Country,</span>
<span id="cb1-11"><a href="#cb1-11"></a>  <span class="st">"Brunei Darussalam"</span> <span class="ot">=</span> <span class="st">"Brunei"</span>,</span>
<span id="cb1-12"><a href="#cb1-12"></a>  <span class="st">"Democratic Republic of the Congo"</span> <span class="ot">=</span> <span class="st">"DR Congo"</span>,</span>
<span id="cb1-13"><a href="#cb1-13"></a>  <span class="st">"Republic of the Congo"</span> <span class="ot">=</span> <span class="st">"Congo"</span>,</span>
<span id="cb1-14"><a href="#cb1-14"></a>  <span class="st">"Côte d'Ivoire"</span> <span class="ot">=</span> <span class="st">"Ivory Coast"</span>,</span>
<span id="cb1-15"><a href="#cb1-15"></a>  <span class="st">"Georgia (country)"</span> <span class="ot">=</span> <span class="st">"Georgia"</span>,</span>
<span id="cb1-16"><a href="#cb1-16"></a>  <span class="st">"Hong Kong SAR"</span> <span class="ot">=</span> <span class="st">"Hong Kong"</span>,</span>
<span id="cb1-17"><a href="#cb1-17"></a>  <span class="st">"Kyrgyz Republic"</span> <span class="ot">=</span> <span class="st">"Kyrgyzstan"</span></span>
<span id="cb1-18"><a href="#cb1-18"></a>)</span>
<span id="cb1-19"><a href="#cb1-19"></a></span>
<span id="cb1-20"><a href="#cb1-20"></a>ec <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"./assets/data/economic_complexity.csv"</span>)</span>
<span id="cb1-21"><a href="#cb1-21"></a><span class="fu">colnames</span>(ec) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Rank"</span>, <span class="st">"Country"</span>, <span class="st">"EC_2018"</span>, <span class="st">"Change_13to18"</span>, <span class="st">"Change_08to18"</span>)</span>
<span id="cb1-22"><a href="#cb1-22"></a>ec <span class="ot">&lt;-</span> ec <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="fu">c</span>(Country, EC_2018))</span>
<span id="cb1-23"><a href="#cb1-23"></a>ec<span class="sc">$</span>EC_2018 <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(ec<span class="sc">$</span>EC_2018)</span>
<span id="cb1-24"><a href="#cb1-24"></a>ec <span class="ot">&lt;-</span> ec <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(EC_2018))</span>
<span id="cb1-25"><a href="#cb1-25"></a></span>
<span id="cb1-26"><a href="#cb1-26"></a>gdp <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"./assets/data/gdp_pc_ppp.csv"</span>)</span>
<span id="cb1-27"><a href="#cb1-27"></a><span class="fu">colnames</span>(gdp) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Country"</span>, <span class="st">"IMF"</span>, <span class="st">"IMF_year"</span>, <span class="st">"WB"</span>, <span class="st">"WB_year"</span>, <span class="st">"CIA"</span>, <span class="st">"CIA_year"</span>)</span>
<span id="cb1-28"><a href="#cb1-28"></a>gdp <span class="ot">&lt;-</span> gdp <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="fu">c</span>(Country, WB))</span>
<span id="cb1-29"><a href="#cb1-29"></a>gdp <span class="ot">&lt;-</span> gdp[<span class="dv">2</span><span class="sc">:</span><span class="fu">nrow</span>(gdp),] <span class="co"># drop first row (not a country)</span></span>
<span id="cb1-30"><a href="#cb1-30"></a>gdp<span class="sc">$</span>Country <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"*"</span>, <span class="st">""</span>, gdp<span class="sc">$</span>Country, <span class="at">fixed=</span>T) <span class="co">#strip * from Country</span></span>
<span id="cb1-31"><a href="#cb1-31"></a>gdp<span class="sc">$</span>WB <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">","</span>, <span class="st">""</span>, gdp<span class="sc">$</span>WB, <span class="at">fixed=</span>T) <span class="co">#strip , from WB</span></span>
<span id="cb1-32"><a href="#cb1-32"></a>gdp<span class="sc">$</span>WB <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(gdp<span class="sc">$</span>WB)</span>
<span id="cb1-33"><a href="#cb1-33"></a>gdp <span class="ot">&lt;-</span> gdp <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(WB))</span>
<span id="cb1-34"><a href="#cb1-34"></a>gdp<span class="sc">$</span>Country <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"\u202F"</span>, <span class="st">""</span>, gdp<span class="sc">$</span>Country)</span>
<span id="cb1-35"><a href="#cb1-35"></a></span>
<span id="cb1-36"><a href="#cb1-36"></a>innov <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"./assets/data/innovation.csv"</span>)</span>
<span id="cb1-37"><a href="#cb1-37"></a><span class="fu">colnames</span>(innov) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Rank"</span>, <span class="st">"Country"</span>, <span class="st">"Score"</span>, <span class="st">"Group"</span>)</span>
<span id="cb1-38"><a href="#cb1-38"></a>innov <span class="ot">&lt;-</span> innov <span class="sc">%&gt;%</span> <span class="fu">select</span>(Country, Score)</span>
<span id="cb1-39"><a href="#cb1-39"></a>innov<span class="sc">$</span>Score <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(innov<span class="sc">$</span>Score)</span>
<span id="cb1-40"><a href="#cb1-40"></a>innov <span class="ot">&lt;-</span> innov <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(Score))</span>
<span id="cb1-41"><a href="#cb1-41"></a></span>
<span id="cb1-42"><a href="#cb1-42"></a>mob <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"./assets/data/social_mobility.csv"</span>)</span>
<span id="cb1-43"><a href="#cb1-43"></a><span class="fu">colnames</span>(mob) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Rank"</span>, <span class="st">"Country"</span>, <span class="st">"Score"</span>)</span>
<span id="cb1-44"><a href="#cb1-44"></a>mob <span class="ot">&lt;-</span> mob <span class="sc">%&gt;%</span> <span class="fu">select</span>(Country, Score)</span>
<span id="cb1-45"><a href="#cb1-45"></a>mob<span class="sc">$</span>Score <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(mob<span class="sc">$</span>Score)</span>
<span id="cb1-46"><a href="#cb1-46"></a>mob <span class="ot">&lt;-</span> mob <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(Score))</span>
<span id="cb1-47"><a href="#cb1-47"></a></span>
<span id="cb1-48"><a href="#cb1-48"></a>prog <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"./assets/data/social_progress.csv"</span>)</span>
<span id="cb1-49"><a href="#cb1-49"></a>prog <span class="ot">&lt;-</span> prog <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="fu">c</span>(Country, <span class="st">`</span><span class="at">Social Progress Score</span><span class="st">`</span>))</span>
<span id="cb1-50"><a href="#cb1-50"></a><span class="fu">colnames</span>(prog) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Country"</span>, <span class="st">"Score"</span>)</span>
<span id="cb1-51"><a href="#cb1-51"></a>prog<span class="sc">$</span>Score <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(prog<span class="sc">$</span>Score)</span>
<span id="cb1-52"><a href="#cb1-52"></a>prog <span class="ot">&lt;-</span> prog <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(Score))</span>
<span id="cb1-53"><a href="#cb1-53"></a>prog<span class="sc">$</span>Country <span class="ot">&lt;-</span> <span class="fu">recode</span>(prog<span class="sc">$</span>Country,</span>
<span id="cb1-54"><a href="#cb1-54"></a>  <span class="st">"Korea, Republic of"</span> <span class="ot">=</span> <span class="st">"South Korea"</span>,</span>
<span id="cb1-55"><a href="#cb1-55"></a>  <span class="st">"Czechia"</span> <span class="ot">=</span> <span class="st">"Czech Republic"</span>,</span>
<span id="cb1-56"><a href="#cb1-56"></a>  <span class="st">"Republic of North Macedonia"</span> <span class="ot">=</span> <span class="st">"North Macedonia"</span>,</span>
<span id="cb1-57"><a href="#cb1-57"></a>  <span class="st">"Cabo Verde"</span> <span class="ot">=</span> <span class="st">"Cape Verde"</span>,</span>
<span id="cb1-58"><a href="#cb1-58"></a>  <span class="st">"West Bank and Gaza"</span> <span class="ot">=</span> <span class="st">"Palestine"</span>,</span>
<span id="cb1-59"><a href="#cb1-59"></a>  <span class="st">"Gambia, The"</span> <span class="ot">=</span> <span class="st">"Gambia"</span>,</span>
<span id="cb1-60"><a href="#cb1-60"></a>  <span class="st">"Côte d'Ivoire"</span> <span class="ot">=</span> <span class="st">"Ivory Coast"</span>,</span>
<span id="cb1-61"><a href="#cb1-61"></a>  <span class="st">"Congo, Republic of"</span> <span class="ot">=</span> <span class="st">"Congo"</span>,</span>
<span id="cb1-62"><a href="#cb1-62"></a>  <span class="st">"Congo, Democratic Republic of"</span> <span class="ot">=</span> <span class="st">"DR Congo"</span></span>
<span id="cb1-63"><a href="#cb1-63"></a>)</span>
<span id="cb1-64"><a href="#cb1-64"></a></span>
<span id="cb1-65"><a href="#cb1-65"></a>gini <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"./assets/data/gini.csv"</span>)</span>
<span id="cb1-66"><a href="#cb1-66"></a><span class="fu">colnames</span>(gini) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Country"</span>, <span class="st">"Year"</span>, <span class="st">"Gini"</span>, <span class="st">"Footnote"</span>)</span>
<span id="cb1-67"><a href="#cb1-67"></a>gini <span class="ot">&lt;-</span> gini <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Year <span class="sc">&gt;=</span> <span class="dv">1980</span>)</span>
<span id="cb1-68"><a href="#cb1-68"></a>gini <span class="ot">&lt;-</span> gini <span class="sc">%&gt;%</span></span>
<span id="cb1-69"><a href="#cb1-69"></a>  <span class="fu">group_by</span>(Country) <span class="sc">%&gt;%</span></span>
<span id="cb1-70"><a href="#cb1-70"></a>  <span class="fu">filter</span>(<span class="fu">sum</span>(<span class="sc">!</span><span class="fu">is.na</span>(Gini)) <span class="sc">&gt;=</span> <span class="dv">10</span>) <span class="sc">%&gt;%</span></span>
<span id="cb1-71"><a href="#cb1-71"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb1-72"><a href="#cb1-72"></a>gini_trend <span class="ot">&lt;-</span> gini <span class="sc">%&gt;%</span></span>
<span id="cb1-73"><a href="#cb1-73"></a>  <span class="fu">group_by</span>(Country) <span class="sc">%&gt;%</span></span>
<span id="cb1-74"><a href="#cb1-74"></a>  <span class="fu">summarise</span>(</span>
<span id="cb1-75"><a href="#cb1-75"></a>    <span class="at">gini_trend =</span> <span class="fu">coef</span>(<span class="fu">lm</span>(Gini <span class="sc">~</span> Year))[<span class="dv">2</span>],</span>
<span id="cb1-76"><a href="#cb1-76"></a>    <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb1-77"><a href="#cb1-77"></a>  )</span>
<span id="cb1-78"><a href="#cb1-78"></a>gini_trend<span class="sc">$</span>Country <span class="ot">&lt;-</span> <span class="fu">recode</span>(gini_trend<span class="sc">$</span>Country,</span>
<span id="cb1-79"><a href="#cb1-79"></a>  <span class="st">"Czechia"</span> <span class="ot">=</span> <span class="st">"Czech Republic"</span>,</span>
<span id="cb1-80"><a href="#cb1-80"></a>  <span class="st">"CÃ´te d'Ivoire"</span> <span class="ot">=</span> <span class="st">"Ivory Coast"</span>,</span>
<span id="cb1-81"><a href="#cb1-81"></a>  <span class="st">"Korea"</span> <span class="ot">=</span> <span class="st">"South Korea"</span>,</span>
<span id="cb1-82"><a href="#cb1-82"></a>  <span class="st">"Kyrgyz Republic"</span> <span class="ot">=</span> <span class="st">"Kyrgyzstan"</span>,</span>
<span id="cb1-83"><a href="#cb1-83"></a>  <span class="st">"Slovak Republic"</span> <span class="ot">=</span> <span class="st">"Slovakia"</span>,</span>
<span id="cb1-84"><a href="#cb1-84"></a>  <span class="st">"Viet Nam"</span> <span class="ot">=</span> <span class="st">"Vietnam"</span></span>
<span id="cb1-85"><a href="#cb1-85"></a>)</span>
<span id="cb1-86"><a href="#cb1-86"></a></span>
<span id="cb1-87"><a href="#cb1-87"></a><span class="co"># country name check</span></span>
<span id="cb1-88"><a href="#cb1-88"></a>df_list <span class="ot">&lt;-</span> <span class="fu">list</span>(debt, ec, gdp, gini_trend, innov, mob, prog)</span>
<span id="cb1-89"><a href="#cb1-89"></a>countries_by_df <span class="ot">&lt;-</span> <span class="fu">lapply</span>(df_list, <span class="cf">function</span>(df) <span class="fu">unique</span>(df<span class="sc">$</span>Country))</span>
<span id="cb1-90"><a href="#cb1-90"></a>common_countries <span class="ot">&lt;-</span> <span class="fu">Reduce</span>(intersect, countries_by_df)</span>
<span id="cb1-91"><a href="#cb1-91"></a>all_countries <span class="ot">&lt;-</span> <span class="fu">unique</span>(<span class="fu">unlist</span>(countries_by_df))</span>
<span id="cb1-92"><a href="#cb1-92"></a>not_shared <span class="ot">&lt;-</span> <span class="fu">setdiff</span>(all_countries, common_countries)</span>
<span id="cb1-93"><a href="#cb1-93"></a>country_presence <span class="ot">&lt;-</span> <span class="fu">sapply</span>(all_countries, <span class="cf">function</span>(country) {</span>
<span id="cb1-94"><a href="#cb1-94"></a>  <span class="fu">sapply</span>(countries_by_df, <span class="cf">function</span>(df_countries) country <span class="sc">%in%</span> df_countries)</span>
<span id="cb1-95"><a href="#cb1-95"></a>})</span>
<span id="cb1-96"><a href="#cb1-96"></a>non_shared_matrix <span class="ot">&lt;-</span> country_presence[, not_shared, drop <span class="ot">=</span> <span class="cn">FALSE</span>]</span>
<span id="cb1-97"><a href="#cb1-97"></a><span class="fu">print</span>(non_shared_matrix)</span>
<span id="cb1-98"><a href="#cb1-98"></a></span>
<span id="cb1-99"><a href="#cb1-99"></a><span class="co"># merging data</span></span>
<span id="cb1-100"><a href="#cb1-100"></a><span class="fu">colnames</span>(debt) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"c"</span>, <span class="st">"debt"</span>)</span>
<span id="cb1-101"><a href="#cb1-101"></a><span class="fu">colnames</span>(ec) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"c"</span>, <span class="st">"ec"</span>)</span>
<span id="cb1-102"><a href="#cb1-102"></a><span class="fu">colnames</span>(gdp) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"c"</span>, <span class="st">"gdp"</span>)</span>
<span id="cb1-103"><a href="#cb1-103"></a><span class="fu">colnames</span>(gini_trend) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"c"</span>, <span class="st">"gini"</span>)</span>
<span id="cb1-104"><a href="#cb1-104"></a><span class="fu">colnames</span>(innov) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"c"</span>, <span class="st">"innov"</span>)</span>
<span id="cb1-105"><a href="#cb1-105"></a><span class="fu">colnames</span>(mob) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"c"</span>, <span class="st">"mob"</span>)</span>
<span id="cb1-106"><a href="#cb1-106"></a><span class="fu">colnames</span>(prog) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"c"</span>, <span class="st">"prog"</span>)</span>
<span id="cb1-107"><a href="#cb1-107"></a>merged_df <span class="ot">&lt;-</span> debt <span class="sc">%&gt;%</span></span>
<span id="cb1-108"><a href="#cb1-108"></a>  <span class="fu">inner_join</span>(ec, <span class="at">by =</span> <span class="st">"c"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb1-109"><a href="#cb1-109"></a>  <span class="fu">inner_join</span>(gdp, <span class="at">by =</span> <span class="st">"c"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb1-110"><a href="#cb1-110"></a>  <span class="fu">inner_join</span>(gini_trend, <span class="at">by =</span> <span class="st">"c"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb1-111"><a href="#cb1-111"></a>  <span class="fu">inner_join</span>(innov, <span class="at">by =</span> <span class="st">"c"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb1-112"><a href="#cb1-112"></a>  <span class="fu">inner_join</span>(mob, <span class="at">by =</span> <span class="st">"c"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb1-113"><a href="#cb1-113"></a>  <span class="fu">inner_join</span>(prog, <span class="at">by =</span> <span class="st">"c"</span>)</span>
<span id="cb1-114"><a href="#cb1-114"></a></span>
<span id="cb1-115"><a href="#cb1-115"></a><span class="co"># box-cox</span></span>
<span id="cb1-116"><a href="#cb1-116"></a>vars <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"debt"</span>, <span class="st">"ec"</span>, <span class="st">"gdp"</span>, <span class="st">"gini"</span>, <span class="st">"innov"</span>, <span class="st">"mob"</span>, <span class="st">"prog"</span>)</span>
<span id="cb1-117"><a href="#cb1-117"></a><span class="cf">for</span>(var <span class="cf">in</span> vars) {</span>
<span id="cb1-118"><a href="#cb1-118"></a>  min_val <span class="ot">&lt;-</span> <span class="fu">min</span>(merged_df[[var]], <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1-119"><a href="#cb1-119"></a>  <span class="cf">if</span>(min_val <span class="sc">&lt;=</span> <span class="dv">0</span>) {</span>
<span id="cb1-120"><a href="#cb1-120"></a>    constant <span class="ot">&lt;-</span> <span class="fu">abs</span>(min_val) <span class="sc">+</span> <span class="dv">1</span>  <span class="co"># Add 1 extra for safety</span></span>
<span id="cb1-121"><a href="#cb1-121"></a>    merged_df[[<span class="fu">paste0</span>(var, <span class="st">"_pos"</span>)]] <span class="ot">&lt;-</span> merged_df[[var]] <span class="sc">+</span> constant</span>
<span id="cb1-122"><a href="#cb1-122"></a>    <span class="fu">cat</span>(var, <span class="st">"shifted by"</span>, constant, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb1-123"><a href="#cb1-123"></a>  } <span class="cf">else</span> {</span>
<span id="cb1-124"><a href="#cb1-124"></a>    merged_df[[<span class="fu">paste0</span>(var, <span class="st">"_pos"</span>)]] <span class="ot">&lt;-</span> merged_df[[var]]</span>
<span id="cb1-125"><a href="#cb1-125"></a>  }</span>
<span id="cb1-126"><a href="#cb1-126"></a>  lambda <span class="ot">&lt;-</span> <span class="fu">BoxCox.lambda</span>(merged_df[[<span class="fu">paste0</span>(var, <span class="st">"_pos"</span>)]])</span>
<span id="cb1-127"><a href="#cb1-127"></a>  merged_df[[<span class="fu">paste0</span>(var, <span class="st">"_bc"</span>)]] <span class="ot">&lt;-</span> <span class="fu">BoxCox</span>(merged_df[[<span class="fu">paste0</span>(var, <span class="st">"_pos"</span>)]], lambda)</span>
<span id="cb1-128"><a href="#cb1-128"></a>  <span class="fu">cat</span>(var, <span class="st">"optimal lambda:"</span>, <span class="fu">round</span>(lambda, <span class="dv">3</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb1-129"><a href="#cb1-129"></a>}</span>
<span id="cb1-130"><a href="#cb1-130"></a></span>
<span id="cb1-131"><a href="#cb1-131"></a><span class="co"># z-scoring</span></span>
<span id="cb1-132"><a href="#cb1-132"></a>df_z <span class="ot">&lt;-</span> merged_df <span class="sc">%&gt;%</span></span>
<span id="cb1-133"><a href="#cb1-133"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">ends_with</span>(<span class="st">"_bc"</span>), <span class="sc">~</span> <span class="fu">scale</span>(.)[,<span class="dv">1</span>]))</span>
<span id="cb1-134"><a href="#cb1-134"></a>df_z <span class="ot">&lt;-</span> df_z <span class="sc">%&gt;%</span> <span class="fu">select</span>(c, <span class="fu">ends_with</span>(<span class="st">"_bc"</span>))</span>
<span id="cb1-135"><a href="#cb1-135"></a>df_z<span class="sc">$</span>gini <span class="ot">&lt;-</span> df_z<span class="sc">$</span>gini_bc <span class="sc">*</span> (<span class="sc">-</span><span class="dv">1</span>) <span class="co"># lower gini = better</span></span>
<span id="cb1-136"><a href="#cb1-136"></a>df_z<span class="sc">$</span>debt <span class="ot">&lt;-</span> df_z<span class="sc">$</span>debt_bc <span class="sc">*</span> (<span class="sc">-</span><span class="dv">1</span>) <span class="co"># lower debt = better</span></span>
<span id="cb1-137"><a href="#cb1-137"></a>df_z<span class="sc">$</span>score <span class="ot">&lt;-</span> <span class="fu">rowSums</span>(df_z[, <span class="sc">-</span><span class="dv">1</span>])</span>
<span id="cb1-138"><a href="#cb1-138"></a>df_z<span class="sc">$</span>rank <span class="ot">&lt;-</span> <span class="fu">rank</span>(<span class="sc">-</span>df_z<span class="sc">$</span>score)</span>
<span id="cb1-139"><a href="#cb1-139"></a></span>
<span id="cb1-140"><a href="#cb1-140"></a><span class="co"># final table</span></span>
<span id="cb1-141"><a href="#cb1-141"></a>final <span class="ot">&lt;-</span> <span class="fu">merge</span>(merged_df, df_z[, <span class="fu">c</span>(<span class="st">"c"</span>, <span class="st">"score"</span>, <span class="st">"rank"</span>)], <span class="at">by =</span> <span class="st">"c"</span>, <span class="at">all.x =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1-142"><a href="#cb1-142"></a>final <span class="ot">&lt;-</span> final <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="fu">c</span>(<span class="st">"c"</span>, <span class="st">"debt"</span>, <span class="st">"ec"</span>, <span class="st">"gdp"</span>, <span class="st">"gini"</span>, <span class="st">"innov"</span>, <span class="st">"mob"</span>, <span class="st">"prog"</span>, <span class="st">"score"</span>, <span class="st">"rank"</span>))</span>
<span id="cb1-143"><a href="#cb1-143"></a>final<span class="sc">$</span>score <span class="ot">&lt;-</span> <span class="fu">round</span>(final<span class="sc">$</span>score, <span class="dv">2</span>)</span>
<span id="cb1-144"><a href="#cb1-144"></a>final<span class="sc">$</span>gini <span class="ot">&lt;-</span> <span class="fu">round</span>(final<span class="sc">$</span>gini, <span class="dv">2</span>)</span>
<span id="cb1-145"><a href="#cb1-145"></a><span class="fu">colnames</span>(final) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Country"</span>, <span class="st">"Debt.Percent.GDP"</span>, <span class="st">"Economic.Complexity.Index"</span>, <span class="st">"GDP.perCapita.PPP"</span>, <span class="st">"GINI.Trend.1980.onwards"</span>, <span class="st">"Global.Innovation.Index"</span>, <span class="st">"Global.Social.Mobility.Index"</span>, <span class="st">"Social.Progress.Index"</span>, <span class="st">"Composite.Score"</span>, <span class="st">"Rank"</span>)</span>
<span id="cb1-146"><a href="#cb1-146"></a>final <span class="ot">&lt;-</span> final[, <span class="fu">c</span>(<span class="st">"Rank"</span>, <span class="st">"Country"</span>, <span class="st">"Composite.Score"</span>, <span class="st">"Economic.Complexity.Index"</span>, <span class="st">"GINI.Trend.1980.onwards"</span>, <span class="st">"Global.Innovation.Index"</span>, <span class="st">"Global.Social.Mobility.Index"</span>, <span class="st">"Social.Progress.Index"</span>, <span class="st">"Debt.Percent.GDP"</span>, <span class="st">"GDP.perCapita.PPP"</span>)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><br>
</p>
</section>
<section id="data" class="level3">
<h3 class="anchored" data-anchor-id="data">Data</h3>
<ul>
<li><a href="./assets/data/debt_gdp.csv">Debt as share of GDP</a></li>
<li><a href="./assets/data/economic_complexity.csv">Economic Complexity Index</a></li>
<li><a href="./assets/data/gdp_pc_ppp.csv">GDP per Capita (PPP)</a></li>
<li><a href="./assets/data/innovation.csv">Innovation Index</a></li>
<li><a href="./assets/data/social_mobility.csv">Social Mobility Index</a></li>
<li><a href="./assets/data/social_progress.csv">Social Progress Index</a></li>
<li><a href="./assets/data/gini.csv">Gini index by country and year</a></li>
</ul>
<p><br>
</p>
</section>
<section id="sessioninfo" class="level3">
<h3 class="anchored" data-anchor-id="sessioninfo">SessionInfo</h3>
<p>Other information that will be helpful for reproducibility</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>R version 4.3.3 (2024-02-29)
Platform: x86_64-conda-linux-gnu (64-bit)
Running under: Freedesktop SDK 24.08 (Flatpak runtime)

Matrix products: default
BLAS/LAPACK: /home/lm/miniconda3/lib/libopenblasp-r0.3.29.so;  LAPACK version 3.12.0

locale:
 [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C              
 [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8    
 [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8   
 [7] LC_PAPER=en_US.UTF-8       LC_NAME=C                 
 [9] LC_ADDRESS=C               LC_TELEPHONE=C            
[11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C       

time zone: US/Pacific
tzcode source: system (glibc)

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
 [1] forecast_8.24.0 DT_0.33         lubridate_1.9.4 forcats_1.0.0  
 [5] stringr_1.5.1   dplyr_1.1.4     purrr_1.0.4     readr_2.1.5    
 [9] tidyr_1.3.1     tibble_3.3.0    ggplot2_3.5.2   tidyverse_2.0.0

loaded via a namespace (and not attached):
 [1] sass_0.4.10        generics_0.1.4     stringi_1.8.7      lattice_0.22-7    
 [5] hms_1.1.3          digest_0.6.37      magrittr_2.0.3     evaluate_1.0.4    
 [9] grid_4.3.3         timechange_0.3.0   RColorBrewer_1.1-3 fastmap_1.2.0     
[13] jsonlite_2.0.0     nnet_7.3-20        crosstalk_1.2.1    scales_1.4.0      
[17] jquerylib_0.1.4    cli_3.6.5          crayon_1.5.3       rlang_1.1.6       
[21] bit64_4.6.0-1      cachem_1.1.0       withr_3.0.2        yaml_2.3.10       
[25] tools_4.3.3        parallel_4.3.3     tzdb_0.5.0         colorspace_2.1-1  
[29] curl_6.2.2         vctrs_0.6.5        R6_2.6.1           zoo_1.8-14        
[33] lifecycle_1.0.4    tseries_0.10-58    bit_4.6.0          htmlwidgets_1.6.4 
[37] vroom_1.6.5        urca_1.3-4         pkgconfig_2.0.3    bslib_0.9.0       
[41] pillar_1.10.2      gtable_0.3.6       quantmod_0.4.28    glue_1.8.0        
[45] Rcpp_1.0.14        xfun_0.52          lmtest_0.9-40      tidyselect_1.2.1  
[49] knitr_1.50         farver_2.1.2       nlme_3.1-168       htmltools_0.5.8.1 
[53] xts_0.14.1         rmarkdown_2.29     timeDate_4041.110  fracdiff_1.5-3    
[57] compiler_4.3.3     quadprog_1.5-8     TTR_0.24.4        </code></pre>
</div>
</div>


</section>
</section>

</main> <!-- /main -->
<div id="utterances-container"></div>

<div id="utterances-container"></div>

<script>
class UtterancesThemeManager {
  constructor() {
    this.container = document.getElementById('utterances-container');
    this.loaded = false;
    this.init();
  }

  getTheme() {
    const checks = [
      () => document.body.classList.contains('quarto-dark'),
      () => document.documentElement.classList.contains('quarto-dark'),
      () => document.body.getAttribute('data-bs-theme') === 'dark',
      () => document.documentElement.getAttribute('data-bs-theme') === 'dark',
      () => document.body.classList.contains('dark'),
      () => document.documentElement.classList.contains('dark')
    ];

    return checks.some(check => {
      try { return check(); } catch { return false; }
    }) ? 'dark' : 'light';
  }

  async waitForPageReady() {
    return new Promise((resolve) => {
      const checkReady = () => {
        const conditions = [
          document.readyState === 'complete',
          document.body.offsetHeight > 0, 
          window.getComputedStyle(document.body).backgroundColor !== '', 
          !document.querySelector('link[rel="stylesheet"]:not([media="print"])') || 
          Array.from(document.querySelectorAll('link[rel="stylesheet"]:not([media="print"])')).every(link => link.sheet)
        ];

        if (conditions.every(Boolean)) {
          setTimeout(resolve, 200);
        } else {
          setTimeout(checkReady, 50);
        }
      };

      checkReady();
    });
  }

  async loadUtterances() {
    if (this.loaded) return;

    try {
      await this.waitForPageReady();

      let theme = this.getTheme();
      await new Promise(resolve => setTimeout(resolve, 100));

      const stableTheme = this.getTheme();
      if (theme !== stableTheme) {
        theme = stableTheme;
        await new Promise(resolve => setTimeout(resolve, 100));
      }

      console.log('Loading Utterances with theme:', theme);

      this.container.innerHTML = '';

      const script = document.createElement('script');
      script.src = 'https://utteranc.es/client.js';
      script.setAttribute('repo', 'lukmayer/site_comments');
      script.setAttribute('issue-term', 'pathname');
      script.setAttribute('theme', theme === 'dark' ? 'github-dark' : 'github-light');
      script.setAttribute('crossorigin', 'anonymous');
      script.setAttribute('async', '');

      script.onload = () => {
        this.loaded = true;
        console.log('Utterances successfully loaded');
      };

      this.container.appendChild(script);

    } catch (error) {
      console.error('Error loading Utterances:', error);
    }
  }

  updateTheme() {
    const iframe = document.querySelector('.utterances-frame');
    if (iframe) {
      const theme = this.getTheme();
      const utterancesTheme = theme === 'dark' ? 'github-dark' : 'github-light';

      try {
        iframe.contentWindow.postMessage(
          { type: 'set-theme', theme: utterancesTheme },
          'https://utteranc.es'
        );
        console.log('Updated Utterances theme to:', theme);
      } catch (e) {
        console.warn('Failed to update Utterances theme:', e);
      }
    }
  }

  setupObservers() {
    let updateTimeout;
    const debouncedUpdate = () => {
      clearTimeout(updateTimeout);
      updateTimeout = setTimeout(() => this.updateTheme(), 150);
    };

    const observerConfig = {
      attributes: true,
      attributeFilter: ['class', 'data-bs-theme']
    };

    [document.body, document.documentElement].forEach(element => {
      const observer = new MutationObserver(debouncedUpdate);
      observer.observe(element, observerConfig);
    });
  }

  init() {
    this.setupObservers();

    if (document.readyState === 'loading') {
      window.addEventListener('load', () => {
        setTimeout(() => this.loadUtterances(), 300);
      });
    } else {
      setTimeout(() => this.loadUtterances(), 500);
    }
  }
}

new UtterancesThemeManager();
</script>
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = true;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https://www.lukmayer.github.io");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
          // target, if specified
          link.setAttribute("target", "_blank");
          if (link.getAttribute("rel") === null) {
            link.setAttribute("rel", "noopener");
          }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      <ul class="footer-items list-unstyled">
    <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/lukmayer/website">
      <i class="bi bi-code-slash" role="img" aria-label="Source code">
</i> 
    </a>
  </li>  
</ul>
    </div>   
    <div class="nav-footer-center">
      <ul class="footer-items list-unstyled">
    <li class="nav-item">
    <a class="nav-link" href="https://quarto.org">
<p>Made with <svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewbox="0 0 24 24"><path fill="currentColor" d="M12.65 12.854V24c6.042-.325 10.923-5.105 11.33-11.125H12.65Zm-1.504 0H.02c.427 5.94 5.166 10.699 11.105 11.105V12.854Zm1.505-1.505H24C23.675 5.247 18.753.325 12.65 0Zm-1.505 0V0C5.106.427.326 5.308 0 11.35Z"></path></svg></p>
</a>
  </li>  
</ul>
    </div>
    <div class="nav-footer-right">
      <ul class="footer-items list-unstyled">
    <li class="nav-item compact">
    <a class="nav-link" href="../../blog/index.xml">
      <i class="bi bi-rss-fill" role="img" aria-label="Blog RSS feed">
</i> 
    </a>
  </li>  
</ul>
    </div>
  </div>
</footer>




<script src="../../site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>